@page "/prescription"
@inject IController controller
@inject IModel model

<h5>Enter patient ID:</h5>

<RadzenTextBox Name="searchPrescriptionText" @bind-Value=@model.SearchPrescriptionPatientId Style="width: 160px" />

<RadzenButton Icon="search" Text="Search" Click=@controller.ShowPrescriptionListAsync Style="width: 160px" />

<h5 style="margin-top: 16px">Patient's Prescriptions</h5>

<RadzenListBox Name="prescriptionList" Data=@model.PrescriptionList TValue="PrescriptionData" SelectedItem=@model.SelectedPrescriptionData Style="width: 324px; height: 240px">
    <Template Context="presriptionData">
        @presriptionData.patientName @presriptionData.patientSurname has prescription from @presriptionData.doctorName @presriptionData.doctorSurname expiring @presriptionData.expirationDate for @drug(presriptionData.drugs)
    </Template>
</RadzenListBox>



<div style="margin-top: 12px; width: 324px; text-align: center">
    <RadzenLink Text="Welcome to our GitLab" Path="https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstleyVEVO" Target="_blank" />
</div>

@code {
    private IController controller_ = ControllerFactory.GetController(new EventDispatcher());

    protected override async Task OnInitializedAsync()
    {
        IModel model1 = controller_.Model;

        IModel model2 = controller.Model;

        IModel model3 = model;
    }

    string drug(IEnumerable<string> drugs)
    {
        string result = "";

        foreach (var drug in drugs)
        {
            result += drug+", ";
        }

        return result;
    }
}
